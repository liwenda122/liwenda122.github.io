webpackJsonp([13],{497:function(t,e,a){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(16),s=a(1),o=i(s);e.default={data:function(){var t=[{path:"/",name:"首页"},{path:"/purchase",name:"开采购单"}],e={date:[],status:"",purchaseno:""},a=[],i={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},n={pageNo:1,pageSize:10,totalCount:0,totalPage:1};return{crumbs:t,formSearch:e,tableData:a,pickerOptions:i,pageData:n,loading:!0,dialogVisible:!1}},methods:{showDialog:function(){this.dialogVisible=!0},closeDialog:function(){this.dialogVisible=!1},onSubmit:function(){this.fetchData()},onCreatePO:function(){this.$router.push({path:"/purchase/create"})},handleView:function(t){this.$router.push({name:"purchaseView",params:{id:t}})},handleEdit:function(t){this.$router.push({name:"purchaseEdit",params:{id:t}})},handleDel:function(t){var e=this,a={purchaseId:t};this.$confirm("确认删除该采购单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http({url:"/pms/purchase/order/delete.do",method:"POST",body:{requestData:JSON.stringify(a)},emulateJSON:!0}).then(function(t){return t.body}).then(function(t){200==t.code?(e.$message({message:"删除成功",type:"success"}),e.fetchData()):e.$message({message:t.message,type:"warning"})})}).catch(function(){})},handleSizeChange:function(t){console.log("每页 "+t+" 条"),this.pageData.pageSize=t,this.fetchData()},handleCurrentChange:function(t){console.log("当前页: "+t),this.pageData.pageNo=t,this.fetchData()},filterStatus:function(t,e){return e.receiptStatus===t},fetchData:function(){var t=this;this.loading=!0;var e={filter:this.formSearch.purchaseno,pageNo:this.pageData.pageNo,pageSize:this.pageData.pageSize};e.startTime=this.formSearch.date.length>0&&this.formSearch.date[0]?(0,o.default)(this.formSearch.date[0]).format("YYYY-MM-DD"):"",e.endTime=this.formSearch.date.length>1&&this.formSearch.date[1]?(0,o.default)(this.formSearch.date[1]).format("YYYY-MM-DD"):"",this.$http({url:"/pms/purchase/order/list.do",method:"POST",body:{requestData:JSON.stringify(e)},emulateJSON:!0}).then(function(t){return t.body}).then(function(e){200==e.code?(t.tableData=e.result.pmsPurchaseOrderVos,t.pageData.pageNo=e.result.pageNo,t.pageData.pageSize=e.result.pageSize,t.pageData.totalCount=e.result.totalCount,t.pageData.totalPage=e.result.totalPage):(t.tableData=[],t.$message({message:e.message,type:"warning"})),t.loading=!1})}},created:function(){this.fetchData()},computed:(0,n.mapState)({user:function(t){return t.user}})}},528:function(t,e,a){e=t.exports=a(8)(),e.push([t.id,".what_onCreatePO[data-v-2dbc34b7]{position:absolute;right:8px;top:0;color:#ff5f00;font-size:16px;cursor:pointer;line-height:60px}.dialogContent[data-v-2dbc34b7]{max-height:500px;overflow:auto}.dialog[data-v-2dbc34b7]{max-width:660px;margin:0 auto}.dialog h1[data-v-2dbc34b7]{font-size:20px;text-align:center;margin-bottom:40px;color:#333;font-weight:700}.dialog h3[data-v-2dbc34b7]{margin-bottom:15px;font-weight:700;color:#333;font-size:16px}.dialog h3 .h3Tips[data-v-2dbc34b7]{display:inline-block;width:23px;height:23px;line-height:23px;margin-right:10px;background-color:#20a0ff;-webkit-border-radius:100%;-moz-border-radius:100%;border-radius:100%;text-align:center;color:#fff}.dialog .function[data-v-2dbc34b7]{margin-bottom:15px}.dialog .function .blue[data-v-2dbc34b7]{color:#20a0ff}.dialog button[data-v-2dbc34b7]{margin:0 5px}.dialog .text[data-v-2dbc34b7]{padding:0 35px;line-height:25px}.dialog .centent[data-v-2dbc34b7]{margin-bottom:40px}.dialog img[data-v-2dbc34b7]{min-height:221px}.dialog .mt20[data-v-2dbc34b7]{margin-top:20px}",""])},563:function(t,e,a){a(598);var i=a(12)(a(497),a(581),"data-v-2dbc34b7",null);t.exports=i.exports},581:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("common-layout",{attrs:{crumbs:t.crumbs}},[a("div",{staticClass:"content",slot:"content"},[a("div",{staticClass:"search-bar"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formSearch}},[a("el-form-item",[a("el-date-picker",{staticStyle:{width:"220px"},attrs:{type:"daterange",align:"right",placeholder:"选择日期范围","picker-options":t.pickerOptions},model:{value:t.formSearch.date,callback:function(e){t.formSearch.date=e},expression:"formSearch.date"}})],1),t._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入采购单号"},model:{value:t.formSearch.purchaseno,callback:function(e){t.formSearch.purchaseno=e},expression:"formSearch.purchaseno"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("查询")])],1)],1)],1),t._v(" "),a("div",{staticClass:"table-content"},[a("div",{staticClass:"button-bar"},[a("el-button",{attrs:{type:"orange"},on:{click:t.onCreatePO}},[t._v("开采购单")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"玩命加载中",data:t.tableData,height:"442",border:""}},[a("el-table-column",{attrs:{label:"序号",width:"70"},inlineTemplate:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[t._v(t._s(t.$index+1+t.pageData.pageSize*(t.pageData.pageNo-1)))])},staticRenderFns:[]}}),t._v(" "),a("el-table-column",{attrs:{prop:"purchaseNo",label:"采购单号","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"开单日期","min-width":"120"},inlineTemplate:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[t._v(t._s(t._f("moment")(t.row.createTime)))])},staticRenderFns:[]}}),t._v(" "),a("el-table-column",{attrs:{prop:"createUserName",label:"开单人","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"receiptStatus",label:"状态","min-width":"100"},inlineTemplate:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tag",{attrs:{type:0==t.row.receiptStatus?"primary":"success","close-transition":""}},[t._v(t._s(0==t.row.receiptStatus?"未收货":1==t.row.status?"已发货未收货":"已收货"))])},staticRenderFns:[]}}),t._v(" "),a("el-table-column",{attrs:{context:t._self,label:"操作","min-width":"120"},inlineTemplate:{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[0!=t.row.receiptStatus?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.handleView(t.row.purchaseId)}}},[t._v("查看")]):t._e(),t._v(" "),0==t.row.receiptStatus?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.handleEdit(t.row.purchaseId)}}},[t._v("编辑")]):t._e(),t._v(" "),0==t.row.receiptStatus?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.handleDel(t.row.purchaseId)}}},[t._v("删除")]):t._e()],1)},staticRenderFns:[]}})],1),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":t.pageData.pageNo,"page-sizes":[10,20,30,40],"page-size":t.pageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.pageData.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),a("span",{staticClass:"what_onCreatePO",on:{click:t.showDialog}},[t._v("如何开采购单？")])])]),t._v(" "),a("el-dialog",{attrs:{title:"帮助",size:"large"},on:{close:t.closeDialog},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}},[a("div",{staticClass:"dialogContent"},[a("div",{staticClass:"dialog"},[a("h1",[t._v("如何开采购单？")]),t._v(" "),a("h3",[a("span",{staticClass:"h3Tips"},[t._v("1")]),t._v("第一步：点击“"),a("el-button",{attrs:{size:"small",type:"orange"}},[t._v("开采购单")]),t._v("”进入>开单页；")],1),t._v(" "),a("div",{staticClass:"centent text"},[a("img",{attrs:{src:"http://kd-oss.oss-cn-hangzhou.aliyuncs.com/image/kdrmspms/caigou1.png"}})]),t._v(" "),a("h3",[a("span",{staticClass:"h3Tips"},[t._v("2")]),t._v("第二步：添加此次所需要采购的物料和数量。")]),t._v(" "),a("div",{staticClass:"centent text"},[a("img",{attrs:{src:"http://kd-oss.oss-cn-hangzhou.aliyuncs.com/image/kdrmspms/caigou2.png"}}),t._v(" "),a("p",{staticClass:"function mt20"},[a("span",{staticClass:"blue"},[t._v("| 方法1：")]),t._v("点击“"),a("el-button",{attrs:{size:"small",type:"primary",icon:"plus"}},[t._v("添加物料")]),t._v("”在物料列表中直接选中自己需要采购的物料（推荐使用）。")],1),t._v(" "),a("p",{staticClass:"function"},[a("span",{staticClass:"blue"},[t._v("| 方法2：")]),t._v("点击“"),a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("导入")]),t._v("”下载EXCEL模板，填入物料批量上传。")],1),t._v(" "),a("p",{staticClass:"function"},[a("span",{staticClass:"blue"},[t._v("| 方法3：")]),t._v("直接在列表中一个个添加（适用于采购物料较少的情况）。")])]),t._v(" "),a("h3",[a("span",{staticClass:"h3Tips"},[t._v("3")]),t._v("第三步：完成下单")]),t._v(" "),a("div",{staticClass:"centent text"},[a("p",[t._v("完成下单后，系统会自动生成一个采购单号，采购单号规则为餐厅名称前三位首写字母+日期+三位编号，如：“肯打鸡餐厅17年1月1日开第一个单，应该为KDG-170101-001。”（采购单只有未收货之前可以编辑，收完货则不可再编辑。）")])])])])])],1)},staticRenderFns:[]}},598:function(t,e,a){var i=a(528);"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);a(13)("5d546c79",i,!0)}});